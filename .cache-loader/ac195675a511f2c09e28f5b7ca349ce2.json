{"remainingRequest":"/home/djan/dev/TickleClient/node_modules/babel-loader/lib/index.js?cacheDirectory=true!/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx","dependencies":[{"path":"/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx","mtime":1517421907719},{"path":"/home/djan/dev/TickleClient/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/home/djan/dev/TickleClient/node_modules/babel-loader/lib/index.js","mtime":1492805601000}],"contextDependencies":[],"result":["import _extends from 'babel-runtime/helpers/extends';\nimport _Object$getPrototypeOf from 'babel-runtime/core-js/object/get-prototype-of';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp, _class2, _temp2;\n\nimport React, { PureComponent, Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport throttle from 'react-throttle-render';\n\n// import styles from './CardOverlay.scss';\n// const window = require('global/window');\nimport HTMLOverlay from './div.react';\nimport SVGOverlay from './svg.react';\n\n// import { HTMLOverlay } from 'react-map-gl';\n\nimport cardIconSrc from './cardIcon.svg';\n\nfunction round(x, n) {\n  var tenN = Math.pow(10, n);\n  return Math.round(x * tenN) / tenN;\n}\n\nvar DivOverlay = (_temp = _class = function (_PureComponent) {\n  _inherits(DivOverlay, _PureComponent);\n\n  function DivOverlay(props) {\n    _classCallCheck(this, DivOverlay);\n\n    var _this = _possibleConstructorReturn(this, (DivOverlay.__proto__ || _Object$getPrototypeOf(DivOverlay)).call(this, props));\n\n    _this.redraw = _this.redraw.bind(_this);\n    return _this;\n  }\n\n  _createClass(DivOverlay, [{\n    key: 'redraw',\n    value: function redraw(opt) {\n      var _props = this.props,\n          data = _props.data,\n          children = _props.children;\n\n      return data.map(function (c) {\n        // TODO\n        var loc = [c.loc.longitude, c.loc.latitude];\n        var pixel = opt.project(loc);\n        var _ref = [round(pixel[0], 1), round(pixel[1], 1)],\n            x = _ref[0],\n            y = _ref[1];\n\n\n        return children(c, [x, y], opt.unproject);\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var node = this.props.node;\n\n\n      var overlay = React.createElement(HTMLOverlay, _extends({}, this.props, { redraw: this.redraw }));\n      if (node !== null) return ReactDOM.createPortal(overlay, node);\n      return overlay;\n    }\n  }]);\n\n  return DivOverlay;\n}(PureComponent), _class.propTypes = {\n  cardClickHandler: PropTypes.func.isRequired,\n  data: PropTypes.array.isRequired,\n  children: PropTypes.oneOfType([PropTypes.func, PropTypes.element]),\n  itemWidth: PropTypes.number,\n  itemHeight: PropTypes.number,\n  location: PropTypes.func,\n  style: PropTypes.object,\n  node: PropTypes.node\n}, _class.defaultProps = { style: {} }, _temp);\n\n\nDivOverlay.defaultProps = {\n  cardClickHandler: function cardClickHandler(d) {\n    return d;\n  },\n  children: React.createElement('div', null),\n  cards: [],\n  itemHeight: 40,\n  itemWidth: 30,\n  node: null\n  // location(c) {return }\n};\n\nvar SlowDivOverlay = throttle(10)(DivOverlay);\n\nvar SvgOverlay = (_temp2 = _class2 = function (_React$Component) {\n  _inherits(SvgOverlay, _React$Component);\n\n  function SvgOverlay(props) {\n    _classCallCheck(this, SvgOverlay);\n\n    var _this2 = _possibleConstructorReturn(this, (SvgOverlay.__proto__ || _Object$getPrototypeOf(SvgOverlay)).call(this, props));\n\n    _this2.redraw = _this2.redraw.bind(_this2);\n    return _this2;\n  }\n\n  _createClass(SvgOverlay, [{\n    key: 'redraw',\n    value: function redraw(opt) {\n      var _props2 = this.props,\n          data = _props2.data,\n          children = _props2.children;\n\n      return data.map(function (c) {\n        var loc = [c.loc.longitude, c.loc.latitude];\n        var pixel = opt.project(loc);\n        var _ref2 = [round(pixel[0], 1), round(pixel[1], 1)],\n            x = _ref2[0],\n            y = _ref2[1];\n\n        return children(c, [x, y], opt.unproject);\n      });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return React.createElement(SVGOverlay, _extends({}, this.props, { redraw: this.redraw }));\n    }\n  }]);\n\n  return SvgOverlay;\n}(React.Component), _class2.propTypes = {\n  cardClickHandler: PropTypes.func.isRequired,\n  data: PropTypes.array.isRequired,\n  children: PropTypes.oneOfType([PropTypes.func, PropTypes.element]),\n  itemWidth: PropTypes.number,\n  itemHeight: PropTypes.number,\n  location: PropTypes.func,\n  style: PropTypes.object\n}, _class2.defaultProps = { style: {} }, _temp2);\n\n\nSvgOverlay.defaultProps = {\n  cardClickHandler: function cardClickHandler(d) {\n    return d;\n  },\n  children: React.createElement('div', null),\n  cards: [],\n  itemHeight: 40,\n  itemWidth: 30\n  // location(c) {return }\n};\n\nvar UserOverlay = function UserOverlay(props) {\n  function redraw(opt) {\n    var _props$location = props.location,\n        longitude = _props$location.longitude,\n        latitude = _props$location.latitude;\n\n    var pixel = opt.project([longitude, latitude]);\n    return React.createElement('i', {\n      style: {\n        transform: 'translate(' + pixel[0] + 'px, ' + pixel[1] + 'px)'\n      },\n      className: 'fa fa-street-view fa-2x',\n      'aria-hidden': 'true'\n    });\n  }\n  return React.createElement(HTMLOverlay, _extends({}, props, { redraw: redraw }));\n};\n\nUserOverlay.propTypes = {\n  location: PropTypes.object.isRequired\n};\n\n// const CardOverlay = ({ cards, onClick, ...mapViewport }) => (\n//   <DivOverlay {...mapViewport} data={cards}>\n//     <img\n//       src={cardIconSrc}\n//       alt=\"icon\"\n//       width={width}\n//       height={height}\n//       onClick={onClick}\n//     />\n//   </DivOverlay>\n// );\n\n// CardOverlay.propTypes = {\n//   mapViewport: PropTypes.object.isRequired,\n//   cards: PropTypes.array.isRequired\n// };\n\n// TODO: rename\nvar CardMarker = function CardMarker(_ref3) {\n  var width = _ref3.width,\n      height = _ref3.height;\n  return React.createElement('img', { src: cardIconSrc, alt: 'icon', width: width, height: height });\n};\n\nCardMarker.propTypes = { width: PropTypes.number, height: PropTypes.number };\nCardMarker.defaultProps = { width: 30, height: 40 };\n\nvar AnimMarker = function AnimMarker(_ref4) {\n  var key = _ref4.key,\n      width = _ref4.width,\n      height = _ref4.height,\n      selected = _ref4.selected,\n      delay = _ref4.delay,\n      x = _ref4.x,\n      y = _ref4.y,\n      children = _ref4.children,\n      onClick = _ref4.onClick,\n      preview = _ref4.preview,\n      node = _ref4.node;\n\n  var marker = React.createElement(\n    'div',\n    {\n      onClick: onClick,\n      style: {\n        position: 'absolute',\n        left: selected ? 0 + 'px' : x - width / 2 + 'px',\n        top: selected ? 0 + 'px' : y - height / 2 + 'px',\n        width: width + 'px',\n        height: height + 'px',\n        transition: 'left ' + delay + 's, top ' + delay + 's, width ' + delay + 's, height ' + delay + 's, opacity ' + delay + 's',\n        zIndex: 5000\n      }\n    },\n    React.createElement(\n      'div',\n      { style: { position: 'relative', width: '100%', height: '100%' } },\n      React.createElement(\n        'div',\n        {\n          className: selected ? 'selectedCard' : null,\n          style: {\n            position: 'absolute',\n            transition: 'width ' + delay + 's, height ' + delay + 's, opacity ' + delay + 's',\n            width: '100%',\n            height: '100%'\n          }\n        },\n        selected ? children : preview\n      )\n    )\n  );\n  if (node !== null) ReactDOM.createPortal(marker, node);\n  return marker;\n};\n\nAnimMarker.propTypes = {\n  delay: PropTypes.number,\n  key: PropTypes.string.isRequired,\n  width: PropTypes.string.isRequired,\n  height: PropTypes.string.isRequired,\n  selected: PropTypes.bool.isRequired,\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  children: PropTypes.node.isRequired,\n  preview: PropTypes.node,\n  node: PropTypes.object\n};\n\nAnimMarker.defaultProps = {\n  delay: 0.5,\n  preview: React.createElement(CardMarker, null),\n  node: null\n};\n\nvar UserMarker = function UserMarker(_ref5) {\n  var x = _ref5.x,\n      y = _ref5.y;\n  return React.createElement('i', {\n    style: {\n      transform: 'translate(' + x + 'px, ' + y + 'px)'\n    },\n    className: 'fa fa-street-view fa-2x',\n    'aria-hidden': 'true'\n  });\n};\n\nexport { SlowDivOverlay, DivOverlay, UserOverlay,\n// CardOverlay,\nCardMarker, AnimMarker, SvgOverlay, UserMarker };\n;\n\nvar _temp3 = function () {\n  if (typeof __REACT_HOT_LOADER__ === 'undefined') {\n    return;\n  }\n\n  __REACT_HOT_LOADER__.register(round, 'round', '/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx');\n\n  __REACT_HOT_LOADER__.register(DivOverlay, 'DivOverlay', '/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx');\n\n  __REACT_HOT_LOADER__.register(SlowDivOverlay, 'SlowDivOverlay', '/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx');\n\n  __REACT_HOT_LOADER__.register(SvgOverlay, 'SvgOverlay', '/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx');\n\n  __REACT_HOT_LOADER__.register(UserOverlay, 'UserOverlay', '/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx');\n\n  __REACT_HOT_LOADER__.register(CardMarker, 'CardMarker', '/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx');\n\n  __REACT_HOT_LOADER__.register(AnimMarker, 'AnimMarker', '/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx');\n\n  __REACT_HOT_LOADER__.register(UserMarker, 'UserMarker', '/home/djan/dev/TickleClient/src/components/utils/map-layers/DivOverlay.jsx');\n}();\n\n;",{"version":3,"sources":["src/components/utils/map-layers/DivOverlay.jsx"],"names":["React","PureComponent","Component","ReactDOM","PropTypes","throttle","HTMLOverlay","SVGOverlay","cardIconSrc","round","x","n","tenN","Math","DivOverlay","props","redraw","bind","opt","data","children","map","loc","c","longitude","latitude","pixel","project","y","unproject","node","overlay","createPortal","propTypes","cardClickHandler","func","isRequired","array","oneOfType","element","itemWidth","number","itemHeight","location","style","object","defaultProps","d","cards","SlowDivOverlay","SvgOverlay","UserOverlay","transform","CardMarker","width","height","AnimMarker","key","selected","delay","onClick","preview","marker","position","left","top","transition","zIndex","string","bool","UserMarker"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,SAA/B,QAAgD,OAAhD;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,QAAP,MAAqB,uBAArB;;AAEA;AACA;AACA,OAAOC,WAAP,MAAwB,aAAxB;AACA,OAAOC,UAAP,MAAuB,aAAvB;;AAEA;;AAEA,OAAOC,WAAP,MAAwB,gBAAxB;;AAEA,SAASC,KAAT,CAAeC,CAAf,EAAkBC,CAAlB,EAAqB;AACnB,MAAMC,gBAAO,EAAP,EAAaD,CAAb,CAAN;AACA,SAAOE,KAAKJ,KAAL,CAAWC,IAAIE,IAAf,IAAuBA,IAA9B;AACD;;IAEKE,U;;;AAcJ,sBAAYC,KAAZ,EAAmB;AAAA;;AAAA,yHACXA,KADW;;AAEjB,UAAKC,MAAL,GAAc,MAAKA,MAAL,CAAYC,IAAZ,OAAd;AAFiB;AAGlB;;;;2BAEMC,G,EAAK;AAAA,mBACiB,KAAKH,KADtB;AAAA,UACFI,IADE,UACFA,IADE;AAAA,UACIC,QADJ,UACIA,QADJ;;AAEV,aAAOD,KAAKE,GAAL,CAAS,aAAK;AACnB;AACA,YAAMC,MAAM,CAACC,EAAED,GAAF,CAAME,SAAP,EAAkBD,EAAED,GAAF,CAAMG,QAAxB,CAAZ;AACA,YAAMC,QAAQR,IAAIS,OAAJ,CAAYL,GAAZ,CAAd;AAHmB,mBAIJ,CAACb,MAAMiB,MAAM,CAAN,CAAN,EAAgB,CAAhB,CAAD,EAAqBjB,MAAMiB,MAAM,CAAN,CAAN,EAAgB,CAAhB,CAArB,CAJI;AAAA,YAIZhB,CAJY;AAAA,YAITkB,CAJS;;;AAMnB,eAAOR,SAASG,CAAT,EAAY,CAACb,CAAD,EAAIkB,CAAJ,CAAZ,EAAoBV,IAAIW,SAAxB,CAAP;AACD,OAPM,CAAP;AAQD;;;6BAEQ;AAAA,UACCC,IADD,GACU,KAAKf,KADf,CACCe,IADD;;;AAGP,UAAMC,UAAU,oBAAC,WAAD,eAAiB,KAAKhB,KAAtB,IAA6B,QAAQ,KAAKC,MAA1C,IAAhB;AACA,UAAIc,SAAS,IAAb,EAAmB,OAAO3B,SAAS6B,YAAT,CAAsBD,OAAtB,EAA+BD,IAA/B,CAAP;AACnB,aAAOC,OAAP;AACD;;;;EArCsB9B,a,UAChBgC,S,GAAY;AACjBC,oBAAkB9B,UAAU+B,IAAV,CAAeC,UADhB;AAEjBjB,QAAMf,UAAUiC,KAAV,CAAgBD,UAFL;AAGjBhB,YAAUhB,UAAUkC,SAAV,CAAoB,CAAClC,UAAU+B,IAAX,EAAiB/B,UAAUmC,OAA3B,CAApB,CAHO;AAIjBC,aAAWpC,UAAUqC,MAJJ;AAKjBC,cAAYtC,UAAUqC,MALL;AAMjBE,YAAUvC,UAAU+B,IANH;AAOjBS,SAAOxC,UAAUyC,MAPA;AAQjBf,QAAM1B,UAAU0B;AARC,C,SAWZgB,Y,GAAe,EAAEF,OAAO,EAAT,E;;;AA4BxB9B,WAAWgC,YAAX,GAA0B;AACxBZ,oBAAkB;AAAA,WAAKa,CAAL;AAAA,GADM;AAExB3B,YAAU,gCAFc;AAGxB4B,SAAO,EAHiB;AAIxBN,cAAY,EAJY;AAKxBF,aAAW,EALa;AAMxBV,QAAM;AACN;AAPwB,CAA1B;;AAUA,IAAMmB,iBAAiB5C,SAAS,EAAT,EAAaS,UAAb,CAAvB;;IAEMoC,U;;;AAaJ,sBAAYnC,KAAZ,EAAmB;AAAA;;AAAA,0HACXA,KADW;;AAEjB,WAAKC,MAAL,GAAc,OAAKA,MAAL,CAAYC,IAAZ,QAAd;AAFiB;AAGlB;;;;2BAEMC,G,EAAK;AAAA,oBACiB,KAAKH,KADtB;AAAA,UACFI,IADE,WACFA,IADE;AAAA,UACIC,QADJ,WACIA,QADJ;;AAEV,aAAOD,KAAKE,GAAL,CAAS,aAAK;AACnB,YAAMC,MAAM,CAACC,EAAED,GAAF,CAAME,SAAP,EAAkBD,EAAED,GAAF,CAAMG,QAAxB,CAAZ;AACA,YAAMC,QAAQR,IAAIS,OAAJ,CAAYL,GAAZ,CAAd;AAFmB,oBAGJ,CAACb,MAAMiB,MAAM,CAAN,CAAN,EAAgB,CAAhB,CAAD,EAAqBjB,MAAMiB,MAAM,CAAN,CAAN,EAAgB,CAAhB,CAArB,CAHI;AAAA,YAGZhB,CAHY;AAAA,YAGTkB,CAHS;;AAInB,eAAOR,SAASG,CAAT,EAAY,CAACb,CAAD,EAAIkB,CAAJ,CAAZ,EAAoBV,IAAIW,SAAxB,CAAP;AACD,OALM,CAAP;AAMD;;;6BAEQ;AACP,aAAO,oBAAC,UAAD,eAAgB,KAAKd,KAArB,IAA4B,QAAQ,KAAKC,MAAzC,IAAP;AACD;;;;EA9BsBhB,MAAME,S,WACtB+B,S,GAAY;AACjBC,oBAAkB9B,UAAU+B,IAAV,CAAeC,UADhB;AAEjBjB,QAAMf,UAAUiC,KAAV,CAAgBD,UAFL;AAGjBhB,YAAUhB,UAAUkC,SAAV,CAAoB,CAAClC,UAAU+B,IAAX,EAAiB/B,UAAUmC,OAA3B,CAApB,CAHO;AAIjBC,aAAWpC,UAAUqC,MAJJ;AAKjBC,cAAYtC,UAAUqC,MALL;AAMjBE,YAAUvC,UAAU+B,IANH;AAOjBS,SAAOxC,UAAUyC;AAPA,C,UAUZC,Y,GAAe,EAAEF,OAAO,EAAT,E;;;AAsBxBM,WAAWJ,YAAX,GAA0B;AACxBZ,oBAAkB;AAAA,WAAKa,CAAL;AAAA,GADM;AAExB3B,YAAU,gCAFc;AAGxB4B,SAAO,EAHiB;AAIxBN,cAAY,EAJY;AAKxBF,aAAW;AACX;AANwB,CAA1B;;AASA,IAAMW,cAAc,SAAdA,WAAc,QAAS;AAC3B,WAASnC,MAAT,CAAgBE,GAAhB,EAAqB;AAAA,0BACaH,MAAM4B,QADnB;AAAA,QACXnB,SADW,mBACXA,SADW;AAAA,QACAC,QADA,mBACAA,QADA;;AAEnB,QAAMC,QAAQR,IAAIS,OAAJ,CAAY,CAACH,SAAD,EAAYC,QAAZ,CAAZ,CAAd;AACA,WACE;AACE,aAAO;AACL2B,kCAAwB1B,MAAM,CAAN,CAAxB,YAAuCA,MAAM,CAAN,CAAvC;AADK,OADT;AAIE,iBAAU,yBAJZ;AAKE,qBAAY;AALd,MADF;AASD;AACD,SAAO,oBAAC,WAAD,eAAiBX,KAAjB,IAAwB,QAAQC,MAAhC,IAAP;AACD,CAfD;;AAiBAmC,YAAYlB,SAAZ,GAAwB;AACtBU,YAAUvC,UAAUyC,MAAV,CAAiBT;AADL,CAAxB;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAMiB,aAAa,SAAbA,UAAa;AAAA,MAAGC,KAAH,SAAGA,KAAH;AAAA,MAAUC,MAAV,SAAUA,MAAV;AAAA,SACjB,6BAAK,KAAK/C,WAAV,EAAuB,KAAI,MAA3B,EAAkC,OAAO8C,KAAzC,EAAgD,QAAQC,MAAxD,GADiB;AAAA,CAAnB;;AAIAF,WAAWpB,SAAX,GAAuB,EAAEqB,OAAOlD,UAAUqC,MAAnB,EAA2Bc,QAAQnD,UAAUqC,MAA7C,EAAvB;AACAY,WAAWP,YAAX,GAA0B,EAAEQ,OAAO,EAAT,EAAaC,QAAQ,EAArB,EAA1B;;AAEA,IAAMC,aAAa,SAAbA,UAAa,QAYb;AAAA,MAXJC,GAWI,SAXJA,GAWI;AAAA,MAVJH,KAUI,SAVJA,KAUI;AAAA,MATJC,MASI,SATJA,MASI;AAAA,MARJG,QAQI,SARJA,QAQI;AAAA,MAPJC,KAOI,SAPJA,KAOI;AAAA,MANJjD,CAMI,SANJA,CAMI;AAAA,MALJkB,CAKI,SALJA,CAKI;AAAA,MAJJR,QAII,SAJJA,QAII;AAAA,MAHJwC,OAGI,SAHJA,OAGI;AAAA,MAFJC,OAEI,SAFJA,OAEI;AAAA,MADJ/B,IACI,SADJA,IACI;;AACJ,MAAMgC,SACJ;AAAA;AAAA;AACE,eAASF,OADX;AAEE,aAAO;AACLG,kBAAU,UADL;AAELC,cAAMN,WAAc,CAAd,UAAyBhD,IAAI4C,QAAQ,CAArC,OAFD;AAGLW,aAAKP,WAAc,CAAd,UAAyB9B,IAAI2B,SAAS,CAAtC,OAHA;AAILD,eAAUA,KAAV,OAJK;AAKLC,gBAAWA,MAAX,OALK;AAMLW,8BAAoBP,KAApB,eAAmCA,KAAnC,iBAAoDA,KAApD,kBAAsEA,KAAtE,mBAAyFA,KAAzF,MANK;AAOLQ,gBAAQ;AAPH;AAFT;AAYE;AAAA;AAAA,QAAK,OAAO,EAAEJ,UAAU,UAAZ,EAAwBT,OAAO,MAA/B,EAAuCC,QAAQ,MAA/C,EAAZ;AACE;AAAA;AAAA;AACE,qBAAWG,WAAW,cAAX,GAA4B,IADzC;AAEE,iBAAO;AACLK,sBAAU,UADL;AAELG,mCAAqBP,KAArB,kBAAuCA,KAAvC,mBAA0DA,KAA1D,MAFK;AAGLL,mBAAO,MAHF;AAILC,oBAAQ;AAJH;AAFT;AASGG,mBAAWtC,QAAX,GAAsByC;AATzB;AADF;AAZF,GADF;AA4BA,MAAI/B,SAAS,IAAb,EAAmB3B,SAAS6B,YAAT,CAAsB8B,MAAtB,EAA8BhC,IAA9B;AACnB,SAAOgC,MAAP;AACD,CA3CD;;AA6CAN,WAAWvB,SAAX,GAAuB;AACrB0B,SAAOvD,UAAUqC,MADI;AAErBgB,OAAKrD,UAAUgE,MAAV,CAAiBhC,UAFD;AAGrBkB,SAAOlD,UAAUgE,MAAV,CAAiBhC,UAHH;AAIrBmB,UAAQnD,UAAUgE,MAAV,CAAiBhC,UAJJ;AAKrBsB,YAAUtD,UAAUiE,IAAV,CAAejC,UALJ;AAMrB1B,KAAGN,UAAUqC,MAAV,CAAiBL,UANC;AAOrBR,KAAGxB,UAAUqC,MAAV,CAAiBL,UAPC;AAQrBhB,YAAUhB,UAAU0B,IAAV,CAAeM,UARJ;AASrByB,WAASzD,UAAU0B,IATE;AAUrBA,QAAM1B,UAAUyC;AAVK,CAAvB;;AAaAW,WAAWV,YAAX,GAA0B;AACxBa,SAAO,GADiB;AAExBE,WAAS,oBAAC,UAAD,OAFe;AAGxB/B,QAAM;AAHkB,CAA1B;;AAMA,IAAMwC,aAAa,SAAbA,UAAa;AAAA,MAAG5D,CAAH,SAAGA,CAAH;AAAA,MAAMkB,CAAN,SAAMA,CAAN;AAAA,SACjB;AACE,WAAO;AACLwB,gCAAwB1C,CAAxB,YAAgCkB,CAAhC;AADK,KADT;AAIE,eAAU,yBAJZ;AAKE,mBAAY;AALd,IADiB;AAAA,CAAnB;;AAUA,SACEqB,cADF,EAEEnC,UAFF,EAGEqC,WAHF;AAIE;AACAE,UALF,EAMEG,UANF,EAOEN,UAPF,EAQEoB,UARF;;;;;;;;gCA3NS7D,K;;gCAKHK,U;;gCAkDAmC,c;;gCAEAC,U;;gCA0CAC,W;;gCAuCAE,U;;gCAOAG,U;;gCAgEAc,U","file":"DivOverlay.jsx","sourceRoot":"/home/djan/dev/TickleClient","sourcesContent":["import React, { PureComponent, Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport throttle from 'react-throttle-render';\n\n// import styles from './CardOverlay.scss';\n// const window = require('global/window');\nimport HTMLOverlay from './div.react';\nimport SVGOverlay from './svg.react';\n\n// import { HTMLOverlay } from 'react-map-gl';\n\nimport cardIconSrc from './cardIcon.svg';\n\nfunction round(x, n) {\n  const tenN = 10 ** n;\n  return Math.round(x * tenN) / tenN;\n}\n\nclass DivOverlay extends PureComponent {\n  static propTypes = {\n    cardClickHandler: PropTypes.func.isRequired,\n    data: PropTypes.array.isRequired,\n    children: PropTypes.oneOfType([PropTypes.func, PropTypes.element]),\n    itemWidth: PropTypes.number,\n    itemHeight: PropTypes.number,\n    location: PropTypes.func,\n    style: PropTypes.object,\n    node: PropTypes.node\n  };\n\n  static defaultProps = { style: {} };\n\n  constructor(props) {\n    super(props);\n    this.redraw = this.redraw.bind(this);\n  }\n\n  redraw(opt) {\n    const { data, children } = this.props;\n    return data.map(c => {\n      // TODO\n      const loc = [c.loc.longitude, c.loc.latitude];\n      const pixel = opt.project(loc);\n      const [x, y] = [round(pixel[0], 1), round(pixel[1], 1)];\n\n      return children(c, [x, y], opt.unproject);\n    });\n  }\n\n  render() {\n    const { node } = this.props;\n\n    const overlay = <HTMLOverlay {...this.props} redraw={this.redraw} />;\n    if (node !== null) return ReactDOM.createPortal(overlay, node);\n    return overlay;\n  }\n}\n\nDivOverlay.defaultProps = {\n  cardClickHandler: d => d,\n  children: <div />,\n  cards: [],\n  itemHeight: 40,\n  itemWidth: 30,\n  node: null\n  // location(c) {return }\n};\n\nconst SlowDivOverlay = throttle(10)(DivOverlay);\n\nclass SvgOverlay extends React.Component {\n  static propTypes = {\n    cardClickHandler: PropTypes.func.isRequired,\n    data: PropTypes.array.isRequired,\n    children: PropTypes.oneOfType([PropTypes.func, PropTypes.element]),\n    itemWidth: PropTypes.number,\n    itemHeight: PropTypes.number,\n    location: PropTypes.func,\n    style: PropTypes.object\n  };\n\n  static defaultProps = { style: {} };\n\n  constructor(props) {\n    super(props);\n    this.redraw = this.redraw.bind(this);\n  }\n\n  redraw(opt) {\n    const { data, children } = this.props;\n    return data.map(c => {\n      const loc = [c.loc.longitude, c.loc.latitude];\n      const pixel = opt.project(loc);\n      const [x, y] = [round(pixel[0], 1), round(pixel[1], 1)];\n      return children(c, [x, y], opt.unproject);\n    });\n  }\n\n  render() {\n    return <SVGOverlay {...this.props} redraw={this.redraw} />;\n  }\n}\n\nSvgOverlay.defaultProps = {\n  cardClickHandler: d => d,\n  children: <div />,\n  cards: [],\n  itemHeight: 40,\n  itemWidth: 30\n  // location(c) {return }\n};\n\nconst UserOverlay = props => {\n  function redraw(opt) {\n    const { longitude, latitude } = props.location;\n    const pixel = opt.project([longitude, latitude]);\n    return (\n      <i\n        style={{\n          transform: `translate(${pixel[0]}px, ${pixel[1]}px)`\n        }}\n        className=\"fa fa-street-view fa-2x\"\n        aria-hidden=\"true\"\n      />\n    );\n  }\n  return <HTMLOverlay {...props} redraw={redraw} />;\n};\n\nUserOverlay.propTypes = {\n  location: PropTypes.object.isRequired\n};\n\n// const CardOverlay = ({ cards, onClick, ...mapViewport }) => (\n//   <DivOverlay {...mapViewport} data={cards}>\n//     <img\n//       src={cardIconSrc}\n//       alt=\"icon\"\n//       width={width}\n//       height={height}\n//       onClick={onClick}\n//     />\n//   </DivOverlay>\n// );\n\n// CardOverlay.propTypes = {\n//   mapViewport: PropTypes.object.isRequired,\n//   cards: PropTypes.array.isRequired\n// };\n\n// TODO: rename\nconst CardMarker = ({ width, height }) => (\n  <img src={cardIconSrc} alt=\"icon\" width={width} height={height} />\n);\n\nCardMarker.propTypes = { width: PropTypes.number, height: PropTypes.number };\nCardMarker.defaultProps = { width: 30, height: 40 };\n\nconst AnimMarker = ({\n  key,\n  width,\n  height,\n  selected,\n  delay,\n  x,\n  y,\n  children,\n  onClick,\n  preview,\n  node\n}) => {\n  const marker = (\n    <div\n      onClick={onClick}\n      style={{\n        position: 'absolute',\n        left: selected ? `${0}px` : `${x - width / 2}px`,\n        top: selected ? `${0}px` : `${y - height / 2}px`,\n        width: `${width}px`,\n        height: `${height}px`,\n        transition: `left ${delay}s, top ${delay}s, width ${delay}s, height ${delay}s, opacity ${delay}s`,\n        zIndex: 5000\n      }}\n    >\n      <div style={{ position: 'relative', width: '100%', height: '100%' }}>\n        <div\n          className={selected ? 'selectedCard' : null}\n          style={{\n            position: 'absolute',\n            transition: `width ${delay}s, height ${delay}s, opacity ${delay}s`,\n            width: '100%',\n            height: '100%'\n          }}\n        >\n          {selected ? children : preview}\n        </div>\n      </div>\n    </div>\n  );\n  if (node !== null) ReactDOM.createPortal(marker, node);\n  return marker;\n};\n\nAnimMarker.propTypes = {\n  delay: PropTypes.number,\n  key: PropTypes.string.isRequired,\n  width: PropTypes.string.isRequired,\n  height: PropTypes.string.isRequired,\n  selected: PropTypes.bool.isRequired,\n  x: PropTypes.number.isRequired,\n  y: PropTypes.number.isRequired,\n  children: PropTypes.node.isRequired,\n  preview: PropTypes.node,\n  node: PropTypes.object\n};\n\nAnimMarker.defaultProps = {\n  delay: 0.5,\n  preview: <CardMarker />,\n  node: null\n};\n\nconst UserMarker = ({ x, y }) => (\n  <i\n    style={{\n      transform: `translate(${x}px, ${y}px)`\n    }}\n    className=\"fa fa-street-view fa-2x\"\n    aria-hidden=\"true\"\n  />\n);\n\nexport {\n  SlowDivOverlay,\n  DivOverlay,\n  UserOverlay,\n  // CardOverlay,\n  CardMarker,\n  AnimMarker,\n  SvgOverlay,\n  UserMarker\n};\n"]}]}